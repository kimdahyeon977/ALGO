```python
'''
49880kb / 512ms
'''
import sys
from bisect import bisect_left, bisect_right
input = sys.stdin.readline

q = []
to_remove = {}
n = int(input())
for _ in range(n):
    P, L = map(int, input().split())
    q.append((L, P))
    to_remove[P] = L

q.sort()

t = int(input())
for _ in range(t):
    order, *args = input().split()
    if order == 'add':
        P, L = map(int, args)
        if P in to_remove and to_remove[P] != 0:
            prev_L = to_remove[P]
            idx = bisect_left(q, (prev_L, P))
            q.pop(idx)
        idx = bisect_left(q, (L, P))
        q.insert(idx, (L, P))
        to_remove[P] = L
    elif order == 'recommend':
        if args[0] == '1':
            print(q[-1][1])
        else:
            print(q[0][1])
    
    else: #solved
        P = int(args[0])
        idx = bisect_left(q, (to_remove[P], P))
        q.pop(idx)
        to_remove[P] = 0
```